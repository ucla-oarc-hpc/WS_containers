<!DOCTYPE html>
<html lang="en"><head>
<script src="WS_containers_files/libs/clipboard/clipboard.min.js"></script>
<script src="WS_containers_files/libs/quarto-html/tabby.min.js"></script>
<script src="WS_containers_files/libs/quarto-html/popper.min.js"></script>
<script src="WS_containers_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="WS_containers_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="WS_containers_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="WS_containers_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="WS_containers_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.290">

  <meta name="author" content="Charles Peterson">
  <title>Using Containers on HPC Resources</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="WS_containers_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="WS_containers_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="WS_containers_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="WS_containers_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="WS_containers_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="WS_containers_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="WS_containers_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Using Containers on HPC Resources</h1>
  <p class="subtitle">Running Your Applications with Ease</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Charles Peterson 
</div>
</div>
</div>

</section>
<section id="learning-objectives" class="slide level2">
<h2>Learning Objectives <span class="emoji" data-emoji="dart">üéØ</span></h2>
<div style="font-size: 0.75em">
<p><strong>Welcome!</strong></p>
<p>In this workshop, we will go over using containers on HPC resources, like UCLA‚Äôs Hoffman2</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>Understand the basics of containers <span class="emoji" data-emoji="books">üìö</span></li>
<li>Learn how containers can be used in HPC environments <span class="emoji" data-emoji="computer">üíª</span></li>
<li>Explore the benefits of containerization <span class="emoji" data-emoji="rocket">üöÄ</span></li>
<li>Get familiar with Apptainer and its workflow <span class="emoji" data-emoji="hammer_and_wrench">üõ†Ô∏è</span></li>
<li>Discover best practices for using containers <span class="emoji" data-emoji="white_check_mark">‚úÖ</span></li>
</ul>
<div class="fragment">
<ul>
<li><p>This is Part I of my workshop on Containers.</p></li>
<li><p><a href="https://idre.ucla.edu/calendar-event/building-containers-for-hpc-2">Part II Next Wednesday on Building Container</a></p></li>
</ul>
</div>
</div><div class="column" style="width:30%;">
<p><img src="fullpic.png" width="70%"></p>
</div>
</div>
</div>
</div>
</section>
<section id="files-for-this-presentation" class="slide level2">
<h2>Files for this Presentation <span class="emoji" data-emoji="file_folder">üìÅ</span></h2>
<p>This presentation can be found on our GitHub page</p>
<ul>
<li>Viewing the slides
<ul>
<li>HTML version: <a href="https://ucla-oarc-hpc.github.io/WS_containers" class="uri">https://ucla-oarc-hpc.github.io/WS_containers</a></li>
<li>PDF version: <code>WS_container.pdf</code></li>
<li>Quarto Markdown version: <code>WS_container.qmd</code></li>
</ul></li>
<li>To download the presentation and example files, run the following command (this will download the files from GitHub):</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">git</span> clone https://github.com/ucla-oarc-hpc/WS_containers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section>
<section id="containers-the-basics" class="title-slide slide level1 center">
<h1>Containers: The Basics</h1>

</section>
<section id="containers-the-basics-1" class="slide level2">
<h2>Containers: The Basics <span class="emoji" data-emoji="package">üì¶</span></h2>
<h3 id="what-are-containers">What Are Containers?</h3>
<div style="font-size: 0.75em">
<ul>
<li>Consistency across platforms <span class="emoji" data-emoji="heavy_check_mark">‚úîÔ∏è</span>
<ul>
<li>Software runs the same way, regardless of where the container is executed.</li>
</ul></li>
<li>Isolation from host system <span class="emoji" data-emoji="lock">üîí</span>
<ul>
<li>Containers do not interfere with other containers or with the host, ensuring a secure execution environment.</li>
</ul></li>
<li>Lightweight and portable <span class="emoji" data-emoji="airplane">‚úàÔ∏è</span>
<ul>
<li>Containers can be easily transferred between systems, cloud providers, or local development environments.</li>
</ul></li>
</ul>
</div>
<div style="display: flex; justify-content: center; align-items: center;">
<p><img src="container_bare.png"></p>
</div>
</section>
<section id="containerizing-applications" class="slide level2">
<h2>Containerizing Applications <span class="emoji" data-emoji="hammer_and_wrench">üõ†Ô∏è</span></h2>
<div style="font-size: 0.75em">
<p>Containers allow you to:</p>
<ul>
<li>Package applications along with all their dependencies, configurations, libraries, and binaries. This comprehensive packaging ensures that the application runs consistently everywhere.</li>
<li>Easily deploy and run them across different systems, facilitating scalability and flexibility.</li>
</ul>
<div style="display: flex; justify-content: center; align-items: center;">
<p><img src="container_apps.png" style="width:90%; height:90%;"></p>
</div>
</div>
</section>
<section id="transferring-containers" class="slide level2">
<h2>Transferring Containers <span class="emoji" data-emoji="truck">üöö</span></h2>
<div style="font-size: 0.75em">
<p>Containers allow for:</p>
<ul>
<li>Easy transfer between different HPC resources.</li>
<li>Ensuring a consistent environment for your software.</li>
</ul>
</div>
<div style="display: flex; justify-content: center; align-items: center;">
<p><img src="container_transfer.png" width="70%"></p>
</div>
<div class="footer">
<p>Image Ref: <a href="https://idre.ucla.edu/featured/hoffman2-brings-new-level-trust-researchers">Hoffman2 source</a>, <a href="https://portal.tacc.utexas.edu/user-guides/stampede2">Stampede2 source</a></p>
</div>
</section>
<section id="understanding-virtualization" class="slide level2">
<h2>Understanding Virtualization <span class="emoji" data-emoji="desktop_computer">üñ•Ô∏è</span></h2>
<p>Containers offer a lightweight, portable, and consistent environment across platforms. To fully grasp the concept of containers, it‚Äôs essential to understand virtualization.</p>
<p><strong>Virtualization</strong> allows multiple operating systems to run simultaneously on a single physical machine. Each operating system operates as if it‚Äôs the only one running on the hardware. While containers share the same OS kernel, virtual machines have their own OS and resources.</p>
<p align="center">
<img src="matrix.gif" alt="Matrix GIF">
</p>
<div class="footer">
<p>GIF from https://giphy.com/</p>
</div>
</section>
<section id="types-of-virtualization" class="slide level2">
<h2>Types of Virtualization <span class="emoji" data-emoji="triangular_ruler">üìê</span></h2>
<div style="font-size: 0.75em">
<ol type="1">
<li><strong>Hardware Virtualization</strong>
<ul>
<li>Creates virtual machines with independent OS and resources on a single physical host.</li>
<li>Ideal for running different operating systems or when complete OS isolation is required.</li>
<li>Example: VirtualBox, VMware, AWS EC2</li>
</ul></li>
<li><strong>Operating System Virtualization (Containers)</strong>
<ul>
<li>Allows multiple isolated user-space instances on the same OS kernel.</li>
<li>Efficient and lightweight, suitable for microservices and scalable applications.</li>
<li>Example: Docker, Apptainer, Kubernetes</li>
</ul></li>
<li><strong>Application Virtualization</strong>
<ul>
<li>Packages applications and their dependencies for execution on any compatible system.</li>
<li>Perfect for deploying apps without worrying about system compatibility or installing dependencies.</li>
<li>Example: App-V, ThinApp, Turbo</li>
</ul></li>
</ol>
</div>
</section>
<section id="bare-metal-setup-no-virtualization" class="slide level2">
<h2>Bare Metal Setup: No Virtualization <span class="emoji" data-emoji="computer">üíª</span></h2>
<div style="font-size: 0.70em">
<ul>
<li>‚ÄòBare metal‚Äô refers to physical servers running directly on hardware without virtualization. <span class="emoji" data-emoji="wrench">üîß</span></li>
<li>Software and applications are installed directly on the host operating system. <span class="emoji" data-emoji="cd">üíø</span></li>
<li>Resources such as CPU, memory, and storage are dedicated and not shared with other virtual machines. <span class="emoji" data-emoji="bar_chart">üìä</span></li>
<li>Advantages: High performance, direct access to hardware, low overhead. <span class="emoji" data-emoji="+1">üëç</span></li>
<li>Limitations: Less flexibility, limited isolation between applications, potential underutilization of resources. <span class="emoji" data-emoji="-1">üëé</span></li>
</ul>
<div class="fragment">
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>Software runs directly on OS from the <strong>physical</strong> hardware</p></li>
<li><p>Typical applications are in this fashion</p>
<ul>
<li>Most <code>module load</code> software</li>
</ul></li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="VMbare.png" class="quarto-discovered-preview-image"></p>
</div>
</div>
</div>
</div>
</section>
<section id="virtual-machines-hardware-level" class="slide level2">
<h2>Virtual Machines: Hardware-Level <span class="emoji" data-emoji="desktop_computer">üñ•Ô∏è</span></h2>
<div style="font-size: 0.60em">
<ul>
<li>Virtual machines (VMs) emulate physical computers and run multiple operating systems on a single host. <span class="emoji" data-emoji="arrow_double_up">‚è´</span></li>
<li>Each VM has its own virtual hardware, including CPU, memory, and storage. <span class="emoji" data-emoji="floppy_disk">üíæ</span></li>
<li>VMs are managed by a hypervisor (e.g., VirtualBox, VMware) that abstracts the physical hardware. <span class="emoji" data-emoji="control_knobs">üéõÔ∏è</span></li>
<li>VMs provide strong isolation between environments and are ideal for development, testing, and legacy applications. <span class="emoji" data-emoji="shield">üõ°Ô∏è</span></li>
<li>Limitations: Additional overhead due to full OS in each VM, performance may be affected by virtualization layer. <span class="emoji" data-emoji="hourglass_flowing_sand">‚è≥</span></li>
</ul>
<div class="fragment">
<div class="columns">
<div class="column" style="width:60%;">
<p><br></p>
<ul>
<li><p>Applications running inside of a VM are running on a completely different set of (virtual) resources</p></li>
<li><p>A ‚ÄúMachine‚Äù within a ‚ÄúMachine‚Äù</p></li>
</ul>
</div><div class="column" style="width:40%;">
<p align="center">
<img src="VM2.png" style="width:60%; height:60%;">
</p>
</div>
</div>
</div>
</div>
</section>
<section id="os-virtualization-containers" class="slide level2">
<h2>OS Virtualization: Containers <span class="emoji" data-emoji="whale">üê≥</span></h2>
<div style="font-size: 0.70em">
<ul>
<li>OS virtualization with containers allows multiple, isolated user-space instances to run on a single host OS.</li>
<li>Containers share the host OS kernel but have their own file system, libraries, and dependencies.</li>
<li>Containers are lightweight, start quickly, and have lower overhead compared to VMs.</li>
<li>Containerization provides a consistent and reproducible environment across platforms.</li>
<li>Containers are ideal for microservices, cloud-native applications, and scalable deployments.</li>
</ul>
<div class="fragment">
<div class="columns">
<div class="column" style="width:60%;">
<p><br></p>
<ul>
<li><p>Applications running inside of a container are running with the <strong>SAME</strong> kernal and physical resources as the host OS</p></li>
<li><p>A ‚ÄúOS‚Äù within a ‚ÄúOS‚Äù</p></li>
</ul>
</div><div class="column" style="width:40%;">
<p align="center">
<img src="VMcontainer.png" style="width:60%; height:60%;">
</p>
</div>
</div>
</div>
</div>
</section>
<section id="why-use-containers" class="slide level2">
<h2>Why use Containers <span class="emoji" data-emoji="question">‚ùì</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Bring your own OS <span class="emoji" data-emoji="earth_americas">üåé</span></li>
<li>Portability <span class="emoji" data-emoji="airplane">‚úàÔ∏è</span></li>
<li>Reproducibility <span class="emoji" data-emoji="repeat">üîÅ</span></li>
<li>Design your own environment <span class="emoji" data-emoji="art">üé®</span></li>
<li>Version control <span class="emoji" data-emoji="bookmark_tabs">üìë</span></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="container1.png"></p>
</div>
</div>
</section>
<section id="challenges-with-software-installation" class="slide level2">
<h2>Challenges with Software Installation <span class="emoji" data-emoji="hammer_and_wrench">üõ†Ô∏è</span></h2>
<div style="font-size: 0.70em">
<ul>
<li>Researchers face difficulties in managing software installations:
<ul>
<li>Spend time setting up software on Hoffman2</li>
<li>Figuring out which versions and modules to load for dependencies</li>
<li>Having to wait for System Admins to help</li>
</ul></li>
<li>Then start all over when using software on a different HPC resource</li>
</ul>
<div class="columns">
<div class="column fragment" style="width:60%;">
<p>HPC resources (like Hoffman2) are <strong>SHARED</strong> resources <span class="emoji" data-emoji="busts_in_silhouette">üë•</span></p>
<ul>
<li>Researchers are running software on the same computing resource</li>
<li>No ‚Äòsudo‚Äô and limited yum/apt-get commands available <span class="emoji" data-emoji="no_entry_sign">üö´</span></li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="container2.png"></p>
</div>
</div>
</div>
</section>
<section id="container-advantages" class="slide level2">
<h2>Container Advantages <span class="emoji" data-emoji="sparkles">‚ú®</span></h2>
<div style="font-size: 0.80em">
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Install your application once:
<ul>
<li>Use on any HPC resource <span class="emoji" data-emoji="globe_with_meridians">üåê</span></li>
</ul></li>
<li>A ‚Äòvirtual‚Äô OS:
<ul>
<li>Users can have complete OS admin control <span class="emoji" data-emoji="lock_with_ink_pen">üîè</span></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="container3.png"></p>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li><p>Great for easily installing software with apt/yum <span class="emoji" data-emoji="package">üì¶</span></p></li>
<li><p>Great if your software requires MANY dependencies that would be complex installing on Hoffman2. <span class="emoji" data-emoji="chains">‚õìÔ∏è</span></p></li>
</ul>
</div><div class="column fragment" style="width:50%;">
<ul>
<li>Easily share containers!! <span class="emoji" data-emoji="handshake">ü§ù</span>
<ul>
<li>Containers as a .SIF file</li>
<li>Save to Container Registry:
<ul>
<li><a href="https://hub.docker.com/">DockerHub</a>, <a href="https://github.com/features/packages">GitHub packages</a>, <a href="https://catalog.ngc.nvidia.com/">Nvidia NGC</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="containerization-vs.-traditional-deployment" class="slide level2">
<h2>Containerization vs.&nbsp;Traditional Deployment <span class="emoji" data-emoji="balance_scale">‚öñÔ∏è</span></h2>
<div style="font-size: 0.80em">
<ul>
<li>Traditional Deployment:
<ul>
<li>Software dependencies must be installed on the host system. <span class="emoji" data-emoji="file_folder">üìÅ</span></li>
<li>Conflicts can occur between different software versions. <span class="emoji" data-emoji="warning">‚ö†Ô∏è</span></li>
<li>Challenging to achieve consistent environments across platforms. <span class="emoji" data-emoji="chart_with_downwards_trend">üìâ</span></li>
</ul></li>
<li>Containerization:
<ul>
<li>Dependencies are packaged within the container. <span class="emoji" data-emoji="gift">üéÅ</span></li>
<li>No conflicts with the host system or other containers. <span class="emoji" data-emoji="peace_symbol">‚òÆÔ∏è</span></li>
<li>Consistent and reproducible environments on any platform. <span class="emoji" data-emoji="chart_with_upwards_trend">üìà</span></li>
</ul></li>
</ul>
</div>
</section>
<section id="software-for-containers" class="slide level2">
<h2>Software for Containers <span class="emoji" data-emoji="wrench">üîß</span></h2>
<div style="font-size: 0.70em">
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="word_cloud.png"></p>
<p>Podman <span class="emoji" data-emoji="package">üì¶</span></p>
<ul>
<li>Similar syntax as with Docker</li>
<li>Doesn‚Äôt have root daemon processes</li>
<li>On some HPC resources (not on Hoffman2, yet) <span class="emoji" data-emoji="soon">üîú</span></li>
</ul>
</div><div class="column" style="width:60%;">
<p>Docker <span class="emoji" data-emoji="whale">üê≥</span></p>
<ul>
<li>One of the most popular containerization software</li>
<li>Many popular cloud container registries to store Docker containers:
<ul>
<li>DockerHub, GitHub Packages, Nvidia NGC</li>
</ul></li>
<li>MPI over multiple servers not well supported <span class="emoji" data-emoji="no_entry_sign">üö´</span></li>
<li>Most likely NOT available on many HPC systems (not on Hoffman2) <span class="emoji" data-emoji="x">‚ùå</span></li>
</ul>
</div>
</div>
</div>
</section></section>
<section>
<section id="apptainer" class="title-slide slide level1 center">
<h1>Apptainer</h1>

<img src="apptainer.png" class="r-stretch"></section>
<section id="apptainer-1" class="slide level2">
<h2>Apptainer <span class="emoji" data-emoji="rocket">üöÄ</span></h2>
<div class="columns">
<div class="column" style="font-size: 0.70em">
<ul>
<li>Formerly Singularity</li>
<li>Designed and developed for HPC systems <span class="emoji" data-emoji="desktop_computer">üñ•Ô∏è</span></li>
<li>Most likely installed on HPC systems (installed on Hoffman2) <span class="emoji" data-emoji="white_check_mark">‚úÖ</span></li>
<li>Supports Infiniband, GPUs, MPI, and other devices on the Host <span class="emoji" data-emoji="zap">‚ö°</span></li>
<li>Can run Docker containers <span class="emoji" data-emoji="whale2">üêã</span></li>
</ul>
</div><div class="column fragment" style="font-size: 0.70em">
<p>Security considerations <span class="emoji" data-emoji="shield">üõ°Ô∏è</span></p>
<ul>
<li>Built with shared user system environments in mind</li>
<li>NO daemon run by root <span class="emoji" data-emoji="no_entry_sign">üö´</span></li>
<li>NO privilege escalation. Cannot gain control over host/Hoffman2 <span class="emoji" data-emoji="lock">üîí</span></li>
<li>All permission restrictions outside of a container apply to the inside <span class="emoji" data-emoji="closed_lock_with_key">üîê</span></li>
</ul>
</div>
</div>
<div style="display: flex; justify-content: center; align-items: center;">
<p><img src="apptainer.png" width="75%"></p>
</div>
</section>
<section id="common-usage-on-hoffman2" class="slide level2">
<h2>Common Usage on Hoffman2 <span class="emoji" data-emoji="bulb">üí°</span></h2>
<div style="font-size: 0.80em">
<p>To use Apptainer on Hoffman2, simply load the module:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="ex">module</span> load apptainer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Only module you need to load!
<ul>
<li>Except for a MPI module if running parallel</li>
</ul></li>
</ul>
<div class="fragment">
<!-- -->
<h3 id="common-apptainer-commands">Common Apptainer Commands:</h3>
<ol type="1">
<li>Getting a container from somewhere</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">apptainer</span> pull <span class="pp">[</span><span class="ss">options</span><span class="pp">]</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="ex">apptainer</span> pull docker://ubuntu:20.04</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>Build a container</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="ex">apptainer</span> build <span class="pp">[</span><span class="ss">options</span><span class="pp">]</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="ex">apptainer</span> build myapp.sif myapp.def</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="common-usage-continued" class="slide level2">
<h2>Common Usage Continued <span class="emoji" data-emoji="wrench">üîß</span></h2>
<p>Common Apptainer commands:</p>
<ol start="3" type="1">
<li>Run a command within a container</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="ex">apptainer</span> exec <span class="pp">[</span><span class="ss">options</span><span class="pp">]</span> container.sif</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="ex">apptainer</span> exec mypython.sif python3 test.py</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Runs the command `python3 test.py` inside the container</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="4" type="1">
<li>Start an interactive session inside your container</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="ex">apptainer</span> shell <span class="pp">[</span><span class="ss">options</span><span class="pp">]</span> container.sif</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="ex">apptainer</span> shell mypython.sif</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Apptainer will NOT run on Hoffman2 login nodes.</p>
</div>
</div>
</div>
</div>
</section>
<section id="apptainer-workflow-for-running-on-h2" class="slide level2">
<h2>Apptainer Workflow for running on H2 <span class="emoji" data-emoji="arrows_counterclockwise">üîÑ</span></h2>
<div class="columns">
<div class="column" style="width:30%;">
<ol type="1">
<li><p>Create <span class="emoji" data-emoji="hammer_and_wrench">üõ†Ô∏è</span></p></li>
<li><p>Transfer <span class="emoji" data-emoji="arrow_right_hook">‚Ü™Ô∏è</span></p></li>
<li><p>Run <span class="emoji" data-emoji="arrow_forward">‚ñ∂Ô∏è</span></p></li>
</ol>
</div><div class="column fragment" style="width:60%;">

</div>
</div>
</section>
<section id="apptainer-workflow-create" class="slide level2">
<h2>Apptainer Workflow (Create) <span class="emoji" data-emoji="hammer_and_wrench">üõ†Ô∏è</span></h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><strong>1. Create</strong> <span class="emoji" data-emoji="hammer_and_wrench">üõ†Ô∏è</span></p>
<ol start="2" type="1">
<li><p>Transfer</p></li>
<li><p>Run</p></li>
</ol>
</div><div class="column fragment" style="font-size: 0.75em">
<ul>
<li>Build a container
<ul>
<li>From Apptainer or Docker on your computer</li>
<li>Where you have root/sudo access</li>
<li>Typically, Apptainer containers end in <code>.sif</code></li>
</ul></li>
<li>Use a pre-built container:
<ul>
<li>Search Container Registries</li>
<li><a href="https://hub.docker.com/">DockerHub</a>, <a href="https://github.com/features/packages">GitHub packages</a>, <a href="https://catalog.ngc.nvidia.com/">Nvidia NGC</a></li>
<li>On H2, <code>$H2_CONTAINER_LOC</code></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="apptainer-workflow-transfer" class="slide level2">
<h2>Apptainer Workflow (Transfer) <span class="emoji" data-emoji="arrow_right_hook">‚Ü™Ô∏è</span></h2>
<div class="columns">
<div class="column" style="width:30%;">
<ol type="1">
<li>Create</li>
</ol>
<p><strong>2. Transfer</strong> <span class="emoji" data-emoji="arrow_right_hook">‚Ü™Ô∏è</span></p>
<ol start="3" type="1">
<li>Run</li>
</ol>
</div><div class="column fragment" style="font-size: 0.80em">
<p>Bring your container to Hoffman2:</p>
<ul>
<li>Copy your container to Hoffman2</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">scp</span> test.sif username@hoffman2.idre.ucla.edu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Pull a container from Container Register</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="ex">apptainer</span> pull docker://ubuntu:20.04</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Use a container pre-built on Hoffman2</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="ex">module</span> load apptainer</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">ls</span> <span class="va">$H2_CONTAINER_LOC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="apptainer-workflow-run" class="slide level2">
<h2>Apptainer workflow (Run) <span class="emoji" data-emoji="arrow_forward">‚ñ∂Ô∏è</span></h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>Create</p>
<p>Transfer</p>
<p><strong>Run</strong> <span class="emoji" data-emoji="arrow_forward">‚ñ∂Ô∏è</span></p>
</div><div class="column fragment" style="font-size: 0.80em">
<p>Run Apptainer on your container:</p>
<ul>
<li>Can run in an interactive (qrsh) session</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1"></a><span class="ex">qrsh</span> <span class="at">-l</span> h_data=20G</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="ex">module</span> load apptainer</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="ex">apptainer</span> exec mypython.sif python3 test.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>Or run as a Batch (qsub) job</p></li>
<li><p>Create job script <code>myjob.job</code></p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#$ -l h_data=20G</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="ex">module</span> load apptainer</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="ex">apptainer</span> exec mypython.sif python3 test.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Submit your job</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a><span class="ex">qsub</span> myjob.job</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="major-takeway" class="slide level2">
<h2><strong>MAJOR TAKEWAY</strong> <span class="emoji" data-emoji="star">‚≠ê</span></h2>
<ul>
<li>Apptainer containers run like any other application.</li>
<li>Run the same commands as you normally would
<ul>
<li>Just add an Apptainer command to any command you want to run inside the container</li>
</ul></li>
</ul>
<p>So‚Ä¶.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1"></a><span class="ex">python3</span> test.py</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="ex">R</span> CMD BATCH test.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Turns into</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1"></a><span class="ex">apptainer</span> exec myPython.sif python3 test.py</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="ex">apptainer</span> exec myR.sif R CMD BATCH test.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section>
<section id="examples" class="title-slide slide level1 center">
<h1>Examples</h1>
<ul>
<li>Example 1: Simple containers with TensorFlow</li>
<li>Example 2: GPU containers with PyTorch</li>
<li>Example 3: Parallel MPI containers</li>
</ul>
<p>You can find the workshop material here:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">git</span> clone https://github.com/ucla-oarc-hpc/WS_containers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-1-tensorflow-1" class="slide level2">
<h2>Example 1: TensorFlow (1) <span class="emoji" data-emoji="brain">üß†</span></h2>
<div style="font-size: 0.80em">
<ul>
<li><p>This example will use <a href="https://www.tensorflow.org/">Tensorflow</a></p>
<ul>
<li>Great library for developing Machine Learning models</li>
</ul></li>
</ul>
<div class="columns fragment">
<div class="column">
<ul>
<li>We will use the <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST</a> dataset
<ul>
<li>Data of over 60,000 training images of handwritten digts</li>
</ul></li>
</ul>
</div><div class="column">
<p><img data-src="mnist.png"></p>
</div>
</div>
<div class="fragment">
<p>We will use TensorFlow to train a model from this dataset</p>
</div>
</div>
</section>
<section id="example-1-tensorflow-2" class="slide level2">
<h2>Example 1: TensorFlow (2)</h2>
<div style="font-size: 0.75em">
<ul>
<li>Go to <code>EX1</code> directory</li>
<li>Look at <code>tf-example.py</code>
<ul>
<li>This example uses TF to train from the MINIST data</li>
</ul></li>
</ul>
<div class="fragment">
<p>Normally, to run this job, we will run</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1"></a><span class="ex">module</span> load python</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="ex">python3</span> tf-example.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>IT DOESN‚ÄôT WORK!!! Need tensorflow installed!!!</p>
<div class="fragment" style="font-size: 0.70em">
<ul>
<li>You can install it your yourself (via pip/conda maybe?)
<ul>
<li>Maybe errors with building</li>
<li>Have to build again using another computer</li>
</ul></li>
</ul>
</div>
<div class="fragment" style="font-size: 0.70em">
<ul>
<li>Instead of installing it yourself, let is find a container!
<ul>
<li>Visit <a href="https://hub.docker.com/">DockerHub</a></li>
<li><a href="https://hub.docker.com/r/tensorflow/tensorflow">‚ÄúOfficial‚Äù TensorFlow container</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="example-1-tensorflow-3" class="slide level2">
<h2>Example 1: TensorFlow (3)</h2>
<h3 id="interactive">Interactive</h3>
<div style="font-size: 0.65em">
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li>Start an interactive session</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1"></a><span class="ex">qrsh</span> <span class="at">-l</span> h_data=20G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li>Load the apptainer module</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1"></a><span class="ex">module</span> load apptainer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li>Pull the TF container from DockerHub</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1"></a><span class="ex">apptainer</span> pull docker://tensorflow/tensorflow:2.7.1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li>We see a file named, <code>tensorflow_2.7.1.sif</code>
<ul>
<li>This SIF file is the container</li>
<li>This container is a OS with python and TF installed inside</li>
</ul></li>
</ul>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li>Start an interactive shell <strong>INSIDE</strong> the container</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1"></a><span class="ex">apptainer</span> shell tensorflow_2.7.1.sif</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li>Now we are in the container, we can run python with TF!</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1"></a><span class="ex">python3</span> tf-example.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<ul>
<li>See that we didn‚Äôt need to load any python module!</li>
<li>We didn‚Äôt need to install any TF packages ourselves!!</li>
<li>Everything is inside the container!</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="example-1-tensorflow-4" class="slide level2">
<h2>Example 1: TensorFlow (4)</h2>
<h3 id="batch">Batch</h3>
<div style="font-size: 0.72em">
<ul>
<li>Going interactively inside the container (Previous slide)
<ul>
<li><code>apptainer shell [container.sif]</code></li>
</ul></li>
<li>Run a single command in the container
<ul>
<li><code>apptainer exec [container.sif] [command]</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1"></a><span class="ex">qrsh</span> <span class="at">-l</span> h_data=20G</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="ex">module</span> load apptainer</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="ex">apptainer</span> pull docker://tensorflow/tensorflow:2.7.1</span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="ex">apptainer</span> exec tensorflow_2.7.1.sif python3 tf-example.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment">
<p>Alternatively, you can submit this as a batch job</p>
<ul>
<li>Example job script: <code>tf-example.job</code></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1"></a><span class="ex">qsub</span> tf-example.job</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="example-2-gpus-with-pytorch-1" class="slide level2">
<h2>Example 2: GPUs with PyTorch (1) <span class="emoji" data-emoji="fireworks">üéÜ</span></h2>
<div style="font-size: 0.65em">
<ul>
<li>This example uses <a href="https://pytorch.org/">PyTorch</a> with GPU support for faster speed <span class="emoji" data-emoji="rocket">üöÄ</span>
<ul>
<li>Another great Machine Learning framework</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Go to the <code>EX2</code> directory
<ul>
<li>Examine the <code>pytorch_gpu.py</code> file</li>
<li>Optimize a 3rd order polynomial to a sine function</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li>To run this example, we‚Äôll need to find a container with GPU support!
<ul>
<li>Let us go to <a href="https://catalog.ngc.nvidia.com/">Nvidia GPU Cloud (NGC)</a></li>
<li>Containers built by Nvidia for GPUs</li>
</ul></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="training_animation.gif"></p>
</div>
</div>
</div>
</section>
<section id="example-2-gpu-job-2" class="slide level2">
<h2>Example 2: GPU job (2)</h2>
<div style="font-size: 0.75em">
<p>Let‚Äôs run <code>python3 pytorch_gpu.py</code> on a GPU node</p>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li>Start an interactive session with a GPU compute node</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1"></a><span class="ex">qrsh</span> <span class="at">-l</span> h_data=20G,gpu,V100</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li>Download the PyTorch container from Nvidia NGC</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1"></a><span class="ex">module</span> load apptainer</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="ex">apptainer</span> pull docker://nvcr.io/nvidia/pytorch:22.03-py3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li>Run apptainer with the <code>--nv</code> option.
<ul>
<li>This enables the container to use the host‚Äôs GPU drivers</li>
</ul></li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1"></a><span class="ex">apptainer</span> shell <span class="at">--nv</span> pytorch_22.03-py3.sif</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="ex">python3</span> <span class="at">-c</span> <span class="st">"import torch; print(f'GPU is available: {torch.cuda.get_device_name(0)}' if torch.cuda.is_available() else 'GPU is NOT available')"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<ul>
<li>Run python3 as a single command</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1"></a><span class="ex">apptainer</span> exec <span class="at">--nv</span> pytorch_22.03-py3.sif python3 pytorch_gpu.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Alternatively, you can submit this as a batch job using a job script</p>
</div><div class="column fragment" style="width:50%;">
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1"></a><span class="ex">qsub</span> pytorch_gpu.job</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="example-3-parallel-mpi-containers" class="slide level2">
<h2>Example 3: Parallel MPI containers <span class="emoji" data-emoji="globe_with_meridians">üåê</span></h2>
<div style="font-size: 0.65em">
<p>In this example, we‚Äôll run a parallel MPI container using <a href="https://nwchemgit.github.io/">NWChem</a>, a popular computational chemistry application.</p>
<p>Many applications use MPI to run across multiple CPUs, and NWChem is one of them.</p>
<div class="fragment">
<ul>
<li>On Hoffman2, a NWChem container with MPI has already been built
<ul>
<li><code>$H2_CONTAINER_LOC/h2-nwchem_7.0.2.sif</code></li>
</ul></li>
</ul>
<p>Typically, we will run NWChem like this:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1"></a><span class="ex">module</span> load intel/2022.1.1</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="ex">module</span> load nwchem/7.0.2</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="kw">`</span><span class="fu">which</span> mpirun<span class="kw">`</span> <span class="at">-np</span> 5 nwchem water.nw <span class="op">&gt;</span> water.out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To run inside the container:</p>
<ul>
<li>Load the intel module
<ul>
<li>Sets up (INTEL)MPI on the host (outside the container)</li>
</ul></li>
<li>Add <code>mpirun</code> in front of <code>apptainer exec</code></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1"></a><span class="ex">qrsh</span> <span class="at">-l</span> h_data=10,arch=intel-gold<span class="pp">*</span> <span class="at">-pe</span> shared 5</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="ex">module</span> load intel/2022.1.1</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="kw">`</span><span class="fu">which</span> mpirun<span class="kw">`</span> <span class="at">-np</span> 5 apptainer exec <span class="va">$H2_CONTAINER_LOC</span>/h2-nwchem_7.0.2.sif nwchem water.nw  <span class="op">&gt;</span> water.out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A example batch job is located in <code>EX3/nwchem.job</code></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1"></a><span class="ex">qsub</span> nwchem.job</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="considerations-and-best-practices" class="slide level2">
<h2>Considerations and Best Practices</h2>
<div style="font-size: 0.75em">
<div class="fragment">
<ul>
<li><span class="emoji" data-emoji="package">üì¶</span> Size of container
<ul>
<li>Keep it small and minimal</li>
<li>Include only necessary components for your applications</li>
<li>Large containers need more memory and take longer to start up</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="emoji" data-emoji="busts_in_silhouette">üë•</span> Share .sif files with your friends!
<ul>
<li><span class="emoji" data-emoji="wrench">üîß</span> Experiment creating your containers</li>
<li>Save your (Docker) containers to DockerHub or GitHub Packages</li>
<li>Find examples of Dockerfiles and Apptainer def files on <a href="https://github.com/charliecpeterson/containers">our GitHub</a></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="emoji" data-emoji="mag">üîç</span> Look out for a follow-up workshop
<ul>
<li><a href="https://idre.ucla.edu/calendar-event/building-containers-for-hpc-2">Container Building</a></li>
</ul></li>
</ul>
</div>
</div>
</section></section>
<section id="thank-you" class="title-slide slide level1 center">
<h1>Thank you!</h1>
<p>Questions? Comments? <span class="emoji" data-emoji="thinking">ü§î</span></p>
<p>Charles Peterson <a href="mailto:cpeterson@oarc.ucla.edu" class="email">cpeterson@oarc.ucla.edu</a></p>
<p><img data-src="padfoot.jpg" width="800" height="450"></p>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="WS_containers_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="WS_containers_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="WS_containers_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="WS_containers_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="WS_containers_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="WS_containers_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="WS_containers_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="WS_containers_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="WS_containers_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="WS_containers_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>